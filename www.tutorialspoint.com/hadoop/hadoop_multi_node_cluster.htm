<!DOCTYPE html>
<!--[if IE 8]><html class="ie ie8"> <![endif]-->
<!--[if IE 9]><html class="ie ie9"> <![endif]-->
<!--[if gt IE 9]><!-->	<html> <!--<![endif]-->
<head>
<!-- Basic -->
<meta charset="utf-8">
<title>Hadoop - Multi Node Cluster</title>
<meta name="description" content="Hadoop Multi Node Cluster - Learn Hadoop in simple and easy steps starting from its Overview, Big Data Overview, Big Bata Solutions, Introduction to Hadoop, Enviornment Setup, Hdfs Overview, Hdfs Operations, Command Reference, Mapreduce, Streaming, Multi Node Cluster." />
<meta name="keywords" content="Hadoop, Tutorial, Beginners, Overview, Big Data Overview, Big Bata Solutions, Introduction to Hadoop, Enviornment Setup, Hdfs Overview, Hdfs Operations, Command Reference, Mapreduce, Streaming, Multi Node Cluster."/>
<base href="https://www.tutorialspoint.com/" />
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
<meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=yes">
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="website" />
<meta property="fb:app_id" content="471319149685276" />
<meta property="og:site_name" content="www.tutorialspoint.com" />
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="author" content="tutorialspoint.com">
<script type="text/javascript" src="https://www.tutorialspoint.com/theme/js/script-min-v4.js?v=2"></script>
<link rel="stylesheet" href="https://www.tutorialspoint.com/theme/css/style-min.css?v=3">
<script>
function openNav() {	
  document.getElementById("mySidenav").style.width = "250px";
  document.getElementById("right_obs").style.display = "block";
}
function closeNav() {
  document.getElementById("mySidenav").style.width = "0";
  document.getElementById("right_obs").style.display = "none";
}
function close_obs_sidenav(){
  document.getElementById("mySidenav").style.width = "0";
  document.getElementById("right_obs").style.display = "none";
}
</script>
<!-- Head Libs -->
<!--[if IE 8]>
<link rel="stylesheet" type="text/css" href="/theme/css/ie8.css">
<![endif]-->
<style>
select{ border:0 !important; outline: 1px inset black !important; outline-offset: -1px !important; }
.btnsbmt{ background: #39b9fa !important;}
ul.nav-list.primary>li a.videolink{    background: none; margin: 0px; padding: 0px; border: 1px solid #d6d6d6;}
div.feature-box div.feature-box-icon, .col-md-3 .course-box, li.heading, div.footer-copyright { background: #39b9fa url(/images/pattern.png) repeat center center !important;}
.sub-main-menu .sub-menuu div:hover, .sub-main-menu .viewall, header nav ul.nav-main li a:hover, button.btn-responsive-nav, header div.search button.btn-default { background: #39b9fa !important;}
.submenu-item{ border-bottom: 2px solid #39b9fa !important; border-top: 2px solid #39b9fa !important }
.ace_scroller{overflow: auto!important;}
a.demo{font-family: "Open Sans",Arial,sans-serif; background:#39b9fa; color:#fff; font-size:13px; padding:3px 10px; border:1px solid #d6d6d6; position:absolute; right:5px; margin:-6px 17px 0px 0px;}
a.demo:hover{opacity:.8}
</style>
<script>
$(document).ready(function() {
  $('input[name="q"]').keydown(function(event){
    if(event.keyCode == 13) {
      event.preventDefault();
      return false;
    }
  });
});
</script>
</head>
<body onload="prettyPrint()">
<div class="wrapLoader">
   <div class="imgLoader">
      <img  src="/images/loading-cg.gif" alt="" width="70" height="70" />
   </div>
</div>
<div id="right_obs" class="display-none" onclick="close_obs_sidenav()"></div>
<header>
   <div class="container">			
      <h1 class="logo">
      <a href="index.htm" title="tutorialspoint">
      <img alt="tutorialspoint" src="/hadoop/images/logo.png">
      </a>
      </h1>			
      <ul class="tp-inline-block pull-right" id="tp-head-icons">
        <li>
           <div class="tp-second-nav tp-display-none tp-pointer" onclick="openNav()">
              <i class="fa fa-th-large fa-lg"></i>
           </div>
        </li>
     </ul>
     <button class="btn btn-responsive-nav btn-inverse" data-toggle="collapse" data-target=".nav-main-collapse" id="pull" style="top: 24px!important"> <i class="icon icon-bars"></i> </button>
      <nav>
         <ul class="nav nav-pills nav-top">
            <li><a href="/about/about_careers.htm" style="background: #fffb09; font-weight: bold;"><i class="icon icon-suitcase"></i> Jobs</a></li>
            <li> <a target="_blank" href="/programming_examples/"><i class="fa fa-cubes"></i> &nbsp;Examples</a> </li>
            <li> <a href="https://www.tutorialspoint.com/whiteboard.htm"><img src="theme/css/icons/image-editor.png" alt="Whiteboard" title="Whiteboard"> &nbsp;Whiteboard</a> </li>
            <li> <a href="https://www.tutorialspoint.com/netmeeting.php"><i class="fa-camera"></i> &nbsp;Net Meeting</a> </li>
            <li> <a href="/online_dev_tools.htm"> <i class="dev-tools-menu" style="opacity:.5"></i> Tools </a> </li>
            <li> <a href="/articles/index.php"><i class="icon icon-file-text-o"></i> &nbsp;Articles</a> </li>            
            <li class="top-icons">
              <ul class="social-icons">
              <li class="facebook"><a href="https://www.facebook.com/tutorialspointindia" target="_blank" rel="nofollow" data-placement="bottom" title="tutorialspoint @ Facebook">Facebook</a></li>
              <li class="googleplus"><a href="https://plus.google.com/u/0/116678774017490391259/posts" target="_blank" rel="nofollow" data-placement="bottom" title="tutorialspoint @ Google+">Google+</a></li>
              <li class="twitter"><a href="https://www.twitter.com/tutorialspoint" target="_blank" rel="nofollow" data-placement="bottom" title="tutorialspoint @ Twitter">Twitter</a></li>
              <li class="linkedin"><a href="https://www.linkedin.com/company/tutorialspoint" target="_blank" rel="nofollow" data-placement="bottom" title="tutorialspoint @ Linkedin">Linkedin</a></li>
              <li class="youtube"><a href="https://www.youtube.com/channel/UCVLbzhxVTiTLiVKeGV7WEBg" target="_blank" rel="nofollow" data-placement="bottom" title="tutorialspoint YouTube">YouTube</a></li>
              </ul>
           </li>
         </ul>
      </nav>
    </div>
     <div class="sidenav" id="mySidenav">
     <div class="navbar nav-main">
      <div class="container">
         <nav class="nav-main mega-menu">
            <ul class="nav nav-pills nav-main" id="mainMenu">
               <li class="dropdown no-sub-menu"> <a class="dropdown" href="index.htm"><i class="icon icon-home"></i> Home</a> </li>   
               <li class="dropdown no-sub-menu"><a class="dropdown" href="/questions/index.php"><i class="fa fa-send"></i> Q/A </a> </li>
               <li class="dropdown"><a class="dropdown" href="tutorialslibrary.htm"><span class="tut-lib"> Library </span></a></li>
               <li class="dropdown no-sub-menu"><a class="dropdown" href="videotutorials/index.htm"><i class="fa-toggle-right"></i> Videos </a></li>
               <li class="dropdown no-sub-menu"><a class="dropdown" href="tutor_connect/index.php"><i class="fa-user"> </i> Tutors</a></li>
               <li class="dropdown no-sub-menu"><a class="dropdown" href="codingground.htm"><i class="fa-code"></i> Coding Ground </a> </li>
               <li class="dropdown no-sub-menu"><a class="dropdown" href="https://store.tutorialspoint.com/"><i class="fa-usd"></i> Store </a> </li>
               <li class="dropdown no-sub-menu">
                  <div class="searchform-popup">
                     <input class="header-search-box" type="text" id="search-string" name="q" placeholder="Search your favorite tutorials..." onfocus="if (this.value == 'Search your favorite tutorials...') {this.value = '';}" onblur="if (this.value == '') {this.value = 'Search your favorite tutorials...';}" autocomplete="off">
                     <div class="magnifying-glass"><i class="icon-search"></i> Search </div>
                 </div>
               </li>
            </ul>
         </nav>
        </div>
      </div>	
     </div>	
   </div>	
</header>
<div style="clear:both;"></div>
<div role="main" class="main">
<div class="container">
<div class="row">
<div class="col-md-2">
<aside class="sidebar">
<div class="mini-logo">
<img src="/hadoop/images/hadoop-mini-logo.jpg" alt="Hadoop Tutorial" />
</div>
<ul class="nav nav-list primary left-menu">
<li class="heading">Hadoop Tutorial</li>
<li><a href="/hadoop/index.htm">Hadoop - Home</a></li>
<li><a href="/hadoop/hadoop_big_data_overview.htm">Hadoop - Big Data Overview</a></li>
<li><a href="/hadoop/hadoop_big_data_solutions.htm">Hadoop - Big Data Solutions</a></li>
<li><a href="/hadoop/hadoop_introduction.htm">Hadoop - Introduction</a></li>
<li><a href="/hadoop/hadoop_enviornment_setup.htm">Hadoop - Environment Setup</a></li>
<li><a href="/hadoop/hadoop_hdfs_overview.htm">Hadoop - HDFS Overview</a></li>
<li><a href="/hadoop/hadoop_hdfs_operations.htm">Hadoop - HDFS Operations</a></li>
<li><a href="/hadoop/hadoop_command_reference.htm">Hadoop - Command Reference</a></li>
<li><a href="/hadoop/hadoop_mapreduce.htm">Hadoop - MapReduce</a></li>
<li><a href="/hadoop/hadoop_streaming.htm">Hadoop - Streaming</a></li>
<li><a href="/hadoop/hadoop_multi_node_cluster.htm">Hadoop - Multi Node Cluster</a></li>
</ul>
<ul class="nav nav-list primary left-menu">
<li class="heading">Hadoop Useful Resources</li>
<li><a  href="/hadoop/hadoop_questions_answers.htm">Hadoop - Questions and Answers</a></li>
<li><a  href="/hadoop/hadoop_quick_guide.htm">Hadoop - Quick Guide</a></li>
<li><a  href="/hadoop/hadoop_useful_resources.htm">Hadoop - Useful Resources</a></li>
<li><a  href="/hadoop/hadoop_discussion.htm">Hadoop - Discussion</a></li>
</ul>
<ul class="nav nav-list primary push-bottom left-menu special">
<li class="sreading">Selected Reading</li>
<li><a target="_top" href="/upsc_ias_exams.htm">UPSC IAS Exams Notes</a></li>
<li><a target="_top" href="/developers_best_practices/index.htm">Developer's Best Practices</a></li>
<li><a target="_top" href="/questions_and_answers.htm">Questions and Answers</a></li>
<li><a target="_top" href="/effective_resume_writing.htm">Effective Resume Writing</a></li>
<li><a target="_top" href="/hr_interview_questions/index.htm">HR Interview Questions</a></li>
<li><a target="_top" href="/computer_glossary.htm">Computer Glossary</a></li>
<li><a target="_top" href="/computer_whoiswho.htm">Who is Who</a></li>
</ul>
 </aside>
</div>
<!-- PRINTING STARTS HERE -->
<div class="row">
<div class="content">
<div class="col-md-7 middle-col">
<h1>Hadoop - Multi Node Cluster</h1>
<hr />
<div style="padding-bottom:5px;padding-left:10px;text-align: center;">Advertisements</div>
<div style="text-align: center;">
<script type="text/javascript"><!--
google_ad_client = "pub-7133395778201029";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_type = "image";
google_ad_channel = "";
//--></script>
<script type="text/javascript"
src="https://pagead2.googlesyndication.com/pagead/show_ads.js"> 
</script>
</div>
<hr />
<div class="pre-btn">
<a href="/hadoop/hadoop_streaming.htm"><i class="icon icon-arrow-circle-o-left big-font"></i> Previous Page</a>
</div>
<div class="nxt-btn">
<a href="/hadoop/hadoop_quick_guide.htm">Next Page <i class="icon icon-arrow-circle-o-right big-font"></i>&nbsp;</a>
</div>
<div class="clearer"></div>
<hr />
<p>This chapter explains the setup of the Hadoop Multi-Node cluster on a distributed environment.</p>
<p>As the whole cluster cannot be demonstrated, we are explaining the Hadoop cluster environment using three systems (one master and two slaves); given below are their IP addresses.</p>
<ul class="list">
<li>Hadoop Master: 192.168.1.15 (hadoop-master)</li>
<li>Hadoop Slave: 192.168.1.16 (hadoop-slave-1)</li>
<li>Hadoop Slave: 192.168.1.17 (hadoop-slave-2)</li>
</ul>
<p>Follow the steps given below to have Hadoop Multi-Node cluster setup.</p>
<h2>Installing Java</h2>
<p>Java is the main prerequisite for Hadoop. First of all, you should verify the existence of java in your system using “java -version”. The syntax of java version command is given below.</p>
<pre class="prettyprint notranslate">
$ java -version
</pre>
<p>If everything works fine it will give you the following output.</p>
<pre class="prettyprint notranslate">
java version "1.7.0_71" 
Java(TM) SE Runtime Environment (build 1.7.0_71-b13) 
Java HotSpot(TM) Client VM (build 25.0-b02, mixed mode)
</pre>
<p>If java is not installed in your system, then follow the given steps for installing java.</p>
<h3>Step 1</h3>
<p>Download java (JDK <latest version> - X64.tar.gz) by visiting the following link <a href=" http://www.oracle.com/technetwork/java/javase/downloads/jdk7-downloads-1880260.html" rel="nofollow" target="_blank">http://www.oracle.com/technetwork/java/javase/downloads/jdk7-downloads-1880260.html</a></p>
<p>Then <b>jdk-7u71-linux-x64.tar.gz</b> will be downloaded into your system.</p>
<h3>Step 2</h3>
<p>Generally you will find the downloaded java file in Downloads folder. Verify it and extract the <b>jdk-7u71-linux-x64.gz</b> file using the following commands.</p>
<pre class="prettyprint notranslate">
$ cd Downloads/
$ ls
jdk-7u71-Linux-x64.gz
$ tar zxf jdk-7u71-Linux-x64.gz
$ ls
jdk1.7.0_71 jdk-7u71-Linux-x64.gz
</pre>
<h3>Step 3</h3>
<p>To make java available to all the users, you have to move it to the location “/usr/local/”. Open the root, and type the following commands.</p>
<pre class="prettyprint notranslate">
$ su
password:
# mv jdk1.7.0_71 /usr/local/
# exit
</pre>
<h3>Step 4</h3>
<p>For setting up <b>PATH</b> and <b>JAVA_HOME</b> variables, add the following commands to <b>~/.bashrc</b> file.</p>
<pre class="prettyprint notranslate">
export JAVA_HOME=/usr/local/jdk1.7.0_71
export PATH=PATH:$JAVA_HOME/bin
</pre>
<p>Now verify the <b>java -version</b> command from the terminal as explained above. Follow the above process and install java in all your cluster nodes.</p>
<h2>Creating User Account</h2>
<p>Create a system user account on both master and slave systems to use the Hadoop installation.</p>
<pre class="prettyprint notranslate">
# useradd hadoop 
# passwd hadoop
</pre>
<h2>Mapping the nodes</h2>
<p>You have to edit <b>hosts</b> file in <b>/etc/</b> folder on all nodes, specify the IP address of each system followed by their host names.</p>
<pre class="prettyprint notranslate">
# vi /etc/hosts
enter the following lines in the /etc/hosts file.
192.168.1.109 hadoop-master 
192.168.1.145 hadoop-slave-1 
192.168.56.1 hadoop-slave-2
</pre>
<h2>Configuring Key Based Login</h2>
<p>Setup ssh in every node such that they can communicate with one another without any prompt for password.</p>
<pre class="prettyprint notranslate">
# su hadoop 
$ ssh-keygen -t rsa 
$ ssh-copy-id -i ~/.ssh/id_rsa.pub tutorialspoint@hadoop-master 
$ ssh-copy-id -i ~/.ssh/id_rsa.pub hadoop_tp1@hadoop-slave-1 
$ ssh-copy-id -i ~/.ssh/id_rsa.pub hadoop_tp2@hadoop-slave-2 
$ chmod 0600 ~/.ssh/authorized_keys 
$ exit
</pre>
<h2>Installing Hadoop</h2>
<p>In the Master server, download and install Hadoop using the following commands.</p>
<pre class="prettyprint notranslate">
# mkdir /opt/hadoop 
# cd /opt/hadoop/ 
# wget http://apache.mesi.com.ar/hadoop/common/hadoop-1.2.1/hadoop-1.2.0.tar.gz 
# tar -xzf hadoop-1.2.0.tar.gz 
# mv hadoop-1.2.0 hadoop
# chown -R hadoop /opt/hadoop 
# cd /opt/hadoop/hadoop/
</pre>
<h2>Configuring Hadoop</h2>
<p>You have to configure Hadoop server by making the following changes as given below.</p>
<h3>core-site.xml</h3>
<p>Open the <b>core-site.xml</b> file and edit it as shown below.</p>
<pre class="prettyprint notranslate">
&lt;configuration&gt;
   &lt;property&gt; 
      &lt;name&gt;fs.default.name&lt;/name&gt; 
      &lt;value&gt;hdfs://hadoop-master:9000/&lt;/value&gt; 
   &lt;/property&gt; 
   &lt;property&gt; 
      &lt;name&gt;dfs.permissions&lt;/name&gt; 
      &lt;value&gt;false&lt;/value&gt; 
   &lt;/property&gt; 
&lt;/configuration&gt;
</pre>
<h3>hdfs-site.xml</h3>
<p>Open the <b>hdfs-site.xml</b> file and edit it as shown below.</p>
<pre class="prettyprint notranslate">
&lt;configuration&gt;
   &lt;property&gt; 
      &lt;name&gt;dfs.data.dir&lt;/name&gt; 
      &lt;value&gt;/opt/hadoop/hadoop/dfs/name/data&lt;/value&gt; 
      &lt;final&gt;true&lt;/final&gt; 
   &lt;/property&gt; 

   &lt;property&gt; 
      &lt;name&gt;dfs.name.dir&lt;/name&gt; 
      &lt;value&gt;/opt/hadoop/hadoop/dfs/name&lt;/value&gt; 
      &lt;final&gt;true&lt;/final&gt; 
   &lt;/property&gt; 

   &lt;property&gt; 
      &lt;name&gt;dfs.replication&lt;/name&gt; 
      &lt;value&gt;1&lt;/value&gt; 
   &lt;/property&gt; 
&lt;/configuration&gt;
</pre>
<h3>mapred-site.xml</h3>
<p>Open the <b>mapred-site.xml</b> file and edit it as shown below.</p>
<pre class="prettyprint notranslate">
&lt;configuration&gt;
   &lt;property&gt; 
      &lt;name&gt;mapred.job.tracker&lt;/name&gt; 
      &lt;value&gt;hadoop-master:9001&lt;/value&gt; 
   &lt;/property&gt; 
&lt;/configuration&gt;
</pre>
<h3>hadoop-env.sh</h3>
<p>Open the <b>hadoop-env.sh</b> file and edit JAVA_HOME, HADOOP_CONF_DIR, and HADOOP_OPTS as shown below.</p>
<p><b>Note:</b> Set the JAVA_HOME as per your system configuration.</p>
<pre class="prettyprint notranslate">
export JAVA_HOME=/opt/jdk1.7.0_17 export HADOOP_OPTS=-Djava.net.preferIPv4Stack=true export HADOOP_CONF_DIR=/opt/hadoop/hadoop/conf
</pre>
<h2>Installing Hadoop on Slave Servers</h2>
<p>Install Hadoop on all the slave servers by following the given commands.</p>
<pre class="prettyprint notranslate">
# su hadoop 
$ cd /opt/hadoop 
$ scp -r hadoop hadoop-slave-1:/opt/hadoop 
$ scp -r hadoop hadoop-slave-2:/opt/hadoop
</pre>
<h2>Configuring Hadoop on Master Server</h2>
<p>Open the master server and configure it by following the given commands.</p>
<pre class="prettyprint notranslate">
# su hadoop 
$ cd /opt/hadoop/hadoop
</pre>
<h3>Configuring Master Node</h3>
<pre class="prettyprint notranslate">
$ vi etc/hadoop/masters
hadoop-master
</pre>
<h3>Configuring Slave Node</h3>
<pre class="prettyprint notranslate">
$ vi etc/hadoop/slaves
hadoop-slave-1 
hadoop-slave-2
</pre>
<h3>Format Name Node on Hadoop Master</h3>
<pre class="prettyprint notranslate">
# su hadoop 
$ cd /opt/hadoop/hadoop 
$ bin/hadoop namenode –format
</pre>
<pre class="prettyprint notranslate">
11/10/14 10:58:07 INFO namenode.NameNode: STARTUP_MSG: /************************************************************ 
STARTUP_MSG: Starting NameNode 
STARTUP_MSG: host = hadoop-master/192.168.1.109 
STARTUP_MSG: args = [-format] 
STARTUP_MSG: version = 1.2.0 
STARTUP_MSG: build = https://svn.apache.org/repos/asf/hadoop/common/branches/branch-1.2 -r 1479473; compiled by 'hortonfo' on Mon May 6 06:59:37 UTC 2013 
STARTUP_MSG: java = 1.7.0_71 ************************************************************/ 11/10/14 10:58:08 INFO util.GSet: Computing capacity for map BlocksMap editlog=/opt/hadoop/hadoop/dfs/name/current/edits
………………………………………………….
………………………………………………….
…………………………………………………. 11/10/14 10:58:08 INFO common.Storage: Storage directory /opt/hadoop/hadoop/dfs/name has been successfully formatted. 11/10/14 10:58:08 INFO namenode.NameNode: 
SHUTDOWN_MSG: /************************************************************ SHUTDOWN_MSG: Shutting down NameNode at hadoop-master/192.168.1.15 ************************************************************/
</pre>
<h2>Starting Hadoop Services</h2>
<p>The following command is to start all the Hadoop services on the Hadoop-Master.</p>
<pre class="prettyprint notranslate">
$ cd $HADOOP_HOME/sbin
$ start-all.sh
</pre>
<h2>Adding a New DataNode in the Hadoop Cluster</h2>
<p>Given below are the steps to be followed for adding new nodes to a Hadoop cluster.</p>
<h3>Networking</h3>
<p>Add new nodes to an existing Hadoop cluster with some appropriate network configuration. Assume the following network configuration.</p>
<p>For New node Configuration:</p>
<pre class="prettyprint notranslate">
IP address : 192.168.1.103 
netmask : 255.255.255.0
hostname : slave3.in
</pre>
<h2>Adding User and SSH Access</h2>
<h3>Add a User</h3>
<p>On a new node, add "hadoop" user and set password of Hadoop user to "hadoop123" or anything you want by using the following commands.</p>
<pre class="prettyprint notranslate">
useradd hadoop
passwd hadoop
</pre>
<p>Setup Password less connectivity from master to new slave.</p>
<h3>Execute the following on the master</h3>
<pre class="prettyprint notranslate">
mkdir -p $HOME/.ssh 
chmod 700 $HOME/.ssh 
ssh-keygen -t rsa -P '' -f $HOME/.ssh/id_rsa 
cat $HOME/.ssh/id_rsa.pub >> $HOME/.ssh/authorized_keys 
chmod 644 $HOME/.ssh/authorized_keys
Copy the public key to new slave node in hadoop user $HOME directory
scp $HOME/.ssh/id_rsa.pub hadoop@192.168.1.103:/home/hadoop/
</pre>
<h3>Execute the following on the slaves</h3>
<p>Login to hadoop. If not, login to hadoop user.</p>
<pre class="prettyprint notranslate">
su hadoop ssh -X hadoop@192.168.1.103
</pre>
<p>Copy the content of public key into file <b>"$HOME/.ssh/authorized_keys"</b> and then change the permission for the same by executing the following commands.</p>
<pre class="prettyprint notranslate">
cd $HOME
mkdir -p $HOME/.ssh 
chmod 700 $HOME/.ssh
cat id_rsa.pub >>$HOME/.ssh/authorized_keys 
chmod 644 $HOME/.ssh/authorized_keys
</pre>
<p>Check ssh login from the master machine. Now check if you can ssh to the new node without a password from the master.</p>
<pre class="prettyprint notranslate">
ssh hadoop@192.168.1.103 or hadoop@slave3
</pre>
<h2>Set Hostname of New Node</h2>
<p>You can set hostname in file <b>/etc/sysconfig/network</b></p>
<pre class="prettyprint notranslate">
On new slave3 machine
NETWORKING=yes 
HOSTNAME=slave3.in
</pre>
<p>To make the changes effective, either restart the machine or run hostname command to a new machine with the respective hostname (restart is a good option).</p>
<p>On slave3 node machine:</p>
<p>hostname slave3.in</p>
<p>Update <b>/etc/hosts</b> on all machines of the cluster with the following lines:</p>
<pre class="prettyprint notranslate">
192.168.1.102 slave3.in slave3
</pre>
<p>Now try to ping the machine with hostnames to check whether it is resolving to IP or not.</p>
<p>On new node machine:</p>
<pre class="prettyprint notranslate">
ping master.in
</pre>
<h2>Start the DataNode on New Node</h2>
<p>Start the datanode daemon manually using <b>$HADOOP_HOME/bin/hadoop-daemon.sh script</b>. It will automatically contact the master (NameNode) and join the cluster. We should also add the new node to the conf/slaves file in the master server. The script-based commands will recognize the new node.</p>
<h3>Login to new node</h3>
<pre class="prettyprint notranslate">
su hadoop or ssh -X hadoop@192.168.1.103
</pre>
<h3>Start HDFS on a newly added slave node by using the following command</h3>
<pre class="prettyprint notranslate">
./bin/hadoop-daemon.sh start datanode
</pre>
<h3>Check the output of jps command on a new node. It looks as follows.</h3>
<pre class="prettyprint notranslate">
$ jps
7141 DataNode
10312 Jps
</pre>
<h2>Removing a DataNode from the Hadoop Cluster</h2>
<p>We can remove a node from a cluster on the fly, while it is running, without any data loss. HDFS provides a decommissioning feature, which ensures that removing a node is performed safely. To use it, follow the steps as given below:</p>
<h3>Step 1: Login to master</h3>
<p>Login to master machine user where Hadoop is installed.</p>
<pre class="prettyprint notranslate">
$ su hadoop
</pre>
<h3>Step 2: Change cluster configuration</h3>
<p>An exclude file must be configured before starting the cluster. Add a key named dfs.hosts.exclude to our <b>$HADOOP_HOME/etc/hadoop/hdfs-site.xml</b> file. The value associated with this key provides the full path to a file on the NameNode's local file system which contains a list of machines which are not permitted to connect to HDFS.</p>
<p>For example, add these lines to <b>etc/hadoop/hdfs-site.xml</b> file.</p>
<pre class="prettyprint notranslate">
&lt;property&gt; 
   &lt;name&gt;dfs.hosts.exclude&lt;/name&gt; 
   &lt;value&gt;/home/hadoop/hadoop-1.2.1/hdfs_exclude.txt&lt;/value&gt; 
   &lt;description&gt;DFS exclude&lt;/description&gt; 
&lt;/property&gt;
</pre>
<h3>Step 3: Determine hosts to decommission</h3>
<p>Each machine to be decommissioned should be added to the file identified by the hdfs_exclude.txt, one domain name per line. This will prevent them from connecting to the NameNode. Content of the <b>"/home/hadoop/hadoop-1.2.1/hdfs_exclude.txt"</b> file is shown below, if you want to remove DataNode2.</p>
<pre class="prettyprint notranslate">
slave2.in
</pre>
<h3>Step 4: Force configuration reload</h3>
<p>Run the command <b>"$HADOOP_HOME/bin/hadoop dfsadmin -refreshNodes"</b> without the quotes.</p>
<pre class="prettyprint notranslate">
$ $HADOOP_HOME/bin/hadoop dfsadmin -refreshNodes
</pre>
<p>This will force the NameNode to re-read its configuration, including the newly updated ‘excludes’ file. It will decommission the nodes over a period of time, allowing time for each node's blocks to be replicated onto machines which are scheduled to remain active.</p>
<p>On <b>slave2.in</b>, check the jps command output. After some time, you will see the DataNode process is shutdown automatically.</p>
<h3>Step 5: Shutdown nodes</h3>
<p>After the decommission process has been completed, the decommissioned hardware can be safely shut down for maintenance. Run the report command to dfsadmin to check the status of decommission. The following command will describe the status of the decommission node and the connected nodes to the cluster.</p>
<pre class="prettyprint notranslate">
$ $HADOOP_HOME/bin/hadoop dfsadmin -report
</pre>
<h3>Step 6: Edit excludes file again</h3>
<p>Once the machines have been decommissioned, they can be removed from the ‘excludes’ file. Running <b>"$HADOOP_HOME/bin/hadoop dfsadmin -refreshNodes"</b> again will read the excludes file back into the NameNode; allowing the DataNodes to rejoin the cluster after the maintenance has been completed, or additional capacity is needed in the cluster again, etc.</p>
<p><b>Special Note:</b> If the above process is followed and the tasktracker process is still running on the node, it needs to be shut down. One way is to disconnect the machine as we did in the above steps. The Master will recognize the process automatically and will declare as dead. There is no need to follow the same process for removing the tasktracker because it is NOT much crucial as compared to the DataNode. DataNode contains the data that you want to remove safely without any loss of data.</p>
<p>The tasktracker can be run/shutdown on the fly by the following command at any point of time.</p>
<pre class="prettyprint notranslate">
$ $HADOOP_HOME/bin/hadoop-daemon.sh stop tasktracker $HADOOP_HOME/bin/hadoop-daemon.sh start tasktracker
</pre>
<hr />
<div class="pre-btn">
<a href="/hadoop/hadoop_streaming.htm"><i class="icon icon-arrow-circle-o-left big-font"></i> Previous Page</a>
</div>
<div class="print-btn center">
<a href="/cgi-bin/printpage.cgi" target="_blank"><i class="icon icon-print big-font"></i> Print</a>
</div>
<div class="pdf-btn">
<a href="/hadoop/pdf/hadoop_multi_node_cluster.pdf" title="Hadoop - Multi Node Cluster" target="_blank"><i class="icon icon-file-pdf-o big-font"></i> PDF</a>
</div>
<div class="nxt-btn">
<a href="/hadoop/hadoop_quick_guide.htm">Next Page <i class="icon icon-arrow-circle-o-right big-font"></i>&nbsp;</a>
</div>
<hr />
<!-- PRINTING ENDS HERE -->
<div class="bottomgooglead">
<div class="bottomadtag">Advertisements</div>
<script><!--
var width = 580;
var height = 400;
var format = "580x400_as";
if( window.innerWidth < 468 ){
   width = 300;
   height = 250;
   format = "300x250_as";
}
google_ad_client = "pub-7133395778201029";
google_ad_width = width;
google_ad_height = height;
google_ad_format = format;
google_ad_type = "image";
google_ad_channel ="";
//--></script>
<script src="https://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>
</div>
</div>
<div class="row">
<div class="col-md-3" id="rightbar">
<div class="simple-ad">
<a href="javascript:void(0)" onclick="var sTop = window.screen.height/2-(218); var sLeft = window.screen.width/2-(313);window.open('https://www.facebook.com/sharer.php?u=' + 'https://www.tutorialspoint.com/hadoop/hadoop_multi_node_cluster.htm','sharer','toolbar=0,status=0,width=626,height=456,top='+sTop+',left='+sLeft);return false;">
<img src="/images/facebookIcon.jpg" alt="img" />
</a>
<a  href="javascript:void(0)" onclick="var sTop = window.screen.height/2-(218); var sLeft = window.screen.width/2-(313);window.open('https://twitter.com/share?url=' + 'https://www.tutorialspoint.com/hadoop/hadoop_multi_node_cluster.htm','sharer','toolbar=0,status=0,width=626,height=456,top='+sTop+',left='+sLeft);return false;">
<img src="/images/twitterIcon.jpg" alt="img" />
</a>
<a  href="javascript:void(0)" onclick="var sTop = window.screen.height/2-(218); var sLeft = window.screen.width/2-(313);window.open('https://www.linkedin.com/cws/share?url=' + 'https://www.tutorialspoint.com/hadoop/hadoop_multi_node_cluster.htm&amp;title='+ document.title,'sharer','toolbar=0,status=0,width=626,height=456,top='+sTop+',left='+sLeft);return false;">
<img src="/images/linkedinIcon.jpg" alt="img" />
</a>
<a  href="javascript:void(0)" onclick="var sTop = window.screen.height/2-(218); var sLeft = window.screen.width/2-(313);window.open('https://plus.google.com/share?url=https://www.tutorialspoint.com/hadoop/hadoop_multi_node_cluster.htm','sharer','toolbar=0,status=0,width=626,height=456,top='+sTop+',left='+sLeft);return false;">
<img src="/images/googlePlusIcon.jpg" alt="img" />
</a>
<a  href="javascript:void(0)" onclick="var sTop = window.screen.height/2-(218); var sLeft = window.screen.width/2-(313);window.open('https://www.stumbleupon.com/submit?url=https://www.tutorialspoint.com/hadoop/hadoop_multi_node_cluster.htm&amp;title='+ document.title,'sharer','toolbar=0,status=0,width=626,height=456,top='+sTop+',left='+sLeft);return false;">
<img src="/images/StumbleUponIcon.jpg" alt="img" />
</a>
<a  href="javascript:void(0)" onclick="var sTop = window.screen.height/2-(218); var sLeft = window.screen.width/2-(313);window.open('https://reddit.com/submit?url=https://www.tutorialspoint.com/hadoop/hadoop_multi_node_cluster.htm&amp;title='+ document.title,'sharer','toolbar=0,status=0,width=626,height=656,top='+sTop+',left='+sLeft);return false;">
<img src="/images/reddit.jpg" alt="img" />
</a>
</div>
<div class="rightgooglead">
<script><!--
google_ad_client = "pub-7133395778201029";
google_ad_width = 300;
google_ad_height = 250;
google_ad_format = "300x250_as";
google_ad_type = "image";
google_ad_channel ="";
//--></script>
<script src="https://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>
<div class="rightgooglead">
<script><!--
google_ad_client = "pub-7133395778201029";
google_ad_width = 300;
google_ad_height = 600;
google_ad_format = "300x600_as";
google_ad_type = "image";
google_ad_channel ="";
//--></script>
<script src="https://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>
<div class="rightgooglead">
<script><!--
google_ad_client = "ca-pub-2537027957187252";
/* Right Side Ad */
google_ad_slot = "right_side_ad";
google_ad_width = 300;
google_ad_height = 250;
//-->
</script>
<script src="https://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>
</div>
</div>
</div>
</div>
</div>

<div class="footer-copyright">
<div class="container">
<div class="row">
<div class="col-md-1">
<a href="index.htm" class="logo"> <img alt="Tutorials Point" class="img-responsive" src="/scripts/img/logo-footer.png"> </a>
</div>
<div class="col-md-4 col-sm-12 col-xs-12">
   <nav id="sub-menu">
      <ul>
         <li><a href="/about/faq.htm">FAQ's</a></li>
         <li><a href="/about/about_privacy.htm#cookies">Cookies Policy</a></li>
         <li><a href="/about/contact_us.htm">Contact</a></li>
      </ul>
   </nav>
</div>
<div class="col-md-3 col-sm-12 col-xs-12">
<p>&copy; Copyright 2018. All Rights Reserved.</p>
</div>
<div class="col-md-4 col-sm-12 col-xs-12">
   <div class="news-group">
      <input type="text" class="form-control-foot search" name="textemail" id="textemail" autocomplete="off" placeholder="Enter email for newsletter" onfocus="if (this.value == 'Enter email for newsletter...') {this.value = '';}" onblur="if (this.value == '') {this.value = 'Enter email for newsletter...';}">
      <span class="input-group-btn"> <button class="btn btn-default btn-footer" id="btnemail" type="submit" onclick="javascript:void(0);">go</button> </span>
      <div id="newsresponse"></div>
   </div>
</div>
</div>
</div>
</div>
</div>
<!-- Libs -->
<script src="/theme/js/custom-min.js?v=7"></script>
<script src="https://www.google-analytics.com/urchin.js">
</script>
<script>
_uacct = "UA-232293-6";
urchinTracker();
$('.pg-icon').click(function(){
   $('.wrapLoader').show();
});
</script>
</div>
</body>
</html>
